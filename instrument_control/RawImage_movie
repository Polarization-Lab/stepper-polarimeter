function imagevideo = RawImage_movie(Directory,file,lambdas,num_meas,Exps)
%Directoy - to h5 file where measurement data is held
%file  - name of .h5 file to be read, input without extension
%lambdas - single value or vector of wavelengths to show images for  

%Directory =  'D:\Measurements\Waveguides\option1\'; %change 
%file = 'SampleMeas-460_530_625-05-Jul-2021.h5'
%lambdas = 530;


imagevideo = VideoWriter(strcat(Directory,file,'-Rawimagemovie.mp4'),'MPEG-4');
imagevideo.FrameRate = 32/15;
open(imagevideo);
set(0,'DefaultFigureVisible', 'off');
file = strcat(file,'.h5');

for jj = 1:length(lambdas)
for ii = 1:num_meas 
    group_name   = strcat('/images/wave',num2str(lambdas(jj)),'/meas',num2str(ii));
    images = h5read(strcat(Directory,file),strcat(group_name,'/imagedata'));
    imagesc(images);
    colormap(gray);
    colorbar;
    title(strcat('\lambda =',num2str(lambdas(jj)),'[nm]',' PSG Orientation =',num2str((ii-1)*2*pi/num_meas),'[rad]'))
    axis equal; %set aspect ratio 1:1
    axis off; %get rid of pixel count
    xlabel(strcat('Exposure Time =',num2str(Exps(jj)),'[s]')) ;
    frame = getframe(gcf);
    writeVideo(imagevideo,frame);
end
hold off
end

set(0,'DefaultFigureVisible', 'on');


close(imagevideo);
