(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47272,       1163]
NotebookOptionsPosition[     43836,       1097]
NotebookOutlinePosition[     44209,       1113]
CellTagsIndexPosition[     44166,       1110]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialize", "Subsection",
 CellChangeTimes->{{3.671568220439497*^9, 3.6715682375842113`*^9}, {
  3.777926581902103*^9, 3.777926582964589*^9}, {3.777926618412368*^9, 
  3.7779266203650846`*^9}},ExpressionUUID->"93bba039-cb26-420b-9693-\
30ed7b778de6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LP", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}], "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}], "^", "2"}]}], ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LR", "[", 
    RowBox[{"\[Delta]_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}], "^", "2"}]}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", "\[Delta]", "]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Delta]", "]"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", "\[Delta]", "]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Delta]", "]"}], " ", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}], "^", "2"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}], "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Delta]", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Delta]", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Theta]"}], "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Delta]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Delta]", "]"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7779097636512003`*^9, 3.7779097970948076`*^9}, {
   3.7779152213169203`*^9, 3.777915453610661*^9}, {3.785508940974532*^9, 
   3.7855089485476418`*^9}, {3.785509192809309*^9, 3.7855091988703527`*^9}, {
   3.7855092360558934`*^9, 3.7855092564454665`*^9}, {3.7855093752054796`*^9, 
   3.785509396659478*^9}, {3.7855094271531887`*^9, 3.7855094390558205`*^9}, {
   3.7855094972255077`*^9, 3.7855095456045165`*^9}, 3.785509595119464*^9, {
   3.7855103646168566`*^9, 3.785510366070315*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"00d0b968-c44a-49c8-b9dc-19f48c4d41e1"],

Cell[CellGroupData[{

Cell["Custom Color Function", "Subsubsection",
 CellChangeTimes->{{3.7303853687879276`*^9, 3.7303853789441423`*^9}, {
   3.7310219858698373`*^9, 3.7310219889578843`*^9}, {3.7312505809640293`*^9, 
   3.7312506053638973`*^9}, {3.731250661948718*^9, 3.7312506642443514`*^9}, {
   3.7317681498383207`*^9, 3.7317681514084363`*^9}, {3.7338340749606466`*^9, 
   3.7338340779206285`*^9}, 
   3.7338341521939287`*^9},ExpressionUUID->"c6b53c55-4dc4-4e1b-96c1-\
1c1b4ca35e95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"divergingCF", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"colorblend", ",", "colorScaleRange"}], "}"}], ",", 
    RowBox[{
     RowBox[{"colorScaleRange", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colorblend", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", ".1", ",", 
           RowBox[{"-", ".5"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".75", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".5", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".25", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"0", ",", "0", ",", "0"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".25", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".5", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".75", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", ".5", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", ".5", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"Blend", "[", 
       RowBox[{"colorblend", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"colorScaleRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"colorScaleRange", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"colorScaleRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], ")"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7372351671019735`*^9, 3.737235188820177*^9}, 
   3.7372352276297827`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"2fc0ecbb-a6bc-4eac-a2c1-b201403c48e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"divergingCFinv", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"colorblend", ",", "colorScaleRange"}], "}"}], ",", 
    RowBox[{
     RowBox[{"colorScaleRange", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colorblend", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"{", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LABColor", "[", 
          RowBox[{".075", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".25", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".5", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".75", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".825", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", "0", ",", 
           RowBox[{"-", ".5"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", ".5", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".825", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".75", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".5", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".25", ",", "1", ",", "1"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LABColor", "[", 
          RowBox[{".075", ",", "1", ",", "1"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"Blend", "[", 
       RowBox[{"colorblend", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "-", 
           RowBox[{"colorScaleRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"colorScaleRange", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"colorScaleRange", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], ")"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7372351671019735`*^9, 3.737235188820177*^9}, 
   3.7372352276297827`*^9, {3.7372353765962014`*^9, 3.7372354164251947`*^9}, {
   3.737235459284175*^9, 3.7372354664480057`*^9}, {3.7372355026153917`*^9, 
   3.7372355343269815`*^9}, {3.7372357871370344`*^9, 3.737235796429039*^9}, {
   3.737235926413235*^9, 3.7372359268752155`*^9}, {3.7372359967478833`*^9, 
   3.7372359968578806`*^9}, {3.7372362710946226`*^9, 
   3.7372362768451147`*^9}, {3.73723638140553*^9, 3.737236393636685*^9}, {
   3.737236498974206*^9, 3.737236504412486*^9}, {3.7372365983926044`*^9, 
   3.7372366689558115`*^9}, {3.737236779281869*^9, 3.737236858757306*^9}, {
   3.737236965222866*^9, 3.737236996543398*^9}, {3.737237101815817*^9, 
   3.7372371154977717`*^9}, {3.737297721913397*^9, 3.7372977262210464`*^9}, {
   3.7372977673900084`*^9, 3.737297770013144*^9}, {3.7372979977242885`*^9, 
   3.737298007839882*^9}, {3.737304080710896*^9, 3.7373041003097935`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"5e4045f6-4138-4d28-8b88-471587266ed3"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate MMImg", "Section",
 CellChangeTimes->{{3.6206992227849846`*^9, 3.6206992321149178`*^9}, {
  3.671568208208274*^9, 3.671568211217575*^9}, {3.777989859918572*^9, 
  3.7779898707288585`*^9}},ExpressionUUID->"77072588-5cee-4ef9-b0a4-\
0fcc2c01a233"],

Cell[CellGroupData[{

Cell["Old File paths", "Subsection",
 CellChangeTimes->{{3.777989877071193*^9, 3.7779898781334133`*^9}, {
  3.793022591356141*^9, 
  3.7930225916723423`*^9}},ExpressionUUID->"21d5a76f-0bd4-468e-8757-\
5bb1bdd54c5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "calfile", " ", "=", " ", 
   "\"\<D:\\\\Measurements\\\\Air_RetarderSwap\\\\air_20191212_450nm-750nm_\
1avg_fullROI_CORRECT\\\\\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "rawfolder", "=", 
   "\"\<C:\\\\Stepper \
Polarimeter\\\\Stepper_Testing\\\\air_20200311_450-750nm-100nm_test\>\""}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.777988427989934*^9, 3.777988444994972*^9}, {
   3.777989151324301*^9, 3.777989201520725*^9}, {3.777990052900803*^9, 
   3.77799006263282*^9}, {3.7782491176088853`*^9, 3.7782491238001485`*^9}, 
   3.778249295705584*^9, {3.778374640191847*^9, 3.7783746538961573`*^9}, {
   3.778374697928932*^9, 3.778374698366332*^9}, {3.778418144528513*^9, 
   3.7784181686004763`*^9}, {3.7805163960535893`*^9, 3.7805164119406347`*^9}, 
   3.7805165620003405`*^9, {3.780516597523819*^9, 3.780516629235362*^9}, {
   3.7851813145188117`*^9, 3.7851813190646033`*^9}, {3.785181357537255*^9, 
   3.785181368298924*^9}, {3.785260841773783*^9, 3.785260842294382*^9}, 
   3.7852610140733485`*^9, 3.7852610671284866`*^9, {3.785261199242941*^9, 
   3.7852612053372135`*^9}, 3.7852612362479115`*^9, {3.7852616686991715`*^9, 
   3.785261669353422*^9}, {3.7852618482785363`*^9, 3.785261865136088*^9}, 
   3.7852619039066553`*^9, {3.7852679228174267`*^9, 3.7852679233099003`*^9}, 
   3.7930221338608756`*^9, {3.7930221664672537`*^9, 3.7930222045102496`*^9}, {
   3.793022242414034*^9, 3.7930222462228184`*^9}, {3.793022507959673*^9, 
   3.793022517783672*^9}, 3.793022926580529*^9, {3.793023857687129*^9, 
   3.7930238817353153`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"15104482-c3a9-4d2e-ad53-d6f57ac562e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["File paths", "Subsection",
 CellChangeTimes->{{3.777989877071193*^9, 
  3.7779898781334133`*^9}},ExpressionUUID->"91add12a-b1b3-4008-ac66-\
dda7510c8d9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "calfile", " ", "=", " ", 
   "\"\<C:\\\\Stepper \
Polarimeter\\\\Stepper_Testing\\\\air_20200310_400-800nm-05nm_test\\\\\
20200312 cal WLs 400-800nm-5\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "rawfolder", "=", 
   "\"\<C:\\\\Stepper \
Polarimeter\\\\Stepper_Testing\\\\air_20200311_450-750nm-100nm_test\>\""}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.793022594855722*^9, 3.7930226335460234`*^9}, {
   3.793022811186304*^9, 3.793022825974042*^9}, 3.7930229704947643`*^9, {
   3.7930238656008415`*^9, 3.793023893399706*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"5ead8e19-4fee-400a-8721-0d3e45255dae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import Calibration Data", "Subsection",
 CellChangeTimes->{{3.7779898838225937`*^9, 
  3.777989900022026*^9}},ExpressionUUID->"fcad4808-2bfe-4560-b096-\
d726a7756029"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"caldata", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"calfile", ",", "\"\<TSV\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Wavelength\>\"", ",", "\"\<Amplitude\>\"", ",", " ", 
         "\"\<PSG Mag\>\"", ",", " ", "\"\<PSG Ori\>\"", ",", 
         "\"\<PSA Ret Mag\>\"", ",", "\"\<PSA Ret Ori\>\"", ",", 
         "\"\<PSA LP Ori\>\"", ",", "\"\<RMSE\>\""}], "}"}], "}"}], ",", 
      RowBox[{"caldata", "\[LeftDoubleBracket]", 
       RowBox[{";;", ",", 
        RowBox[{"1", ";;", "8"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
    RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7779884976393375`*^9, 3.7779885188718343`*^9}, 
   3.7779891888828025`*^9, {3.77798982981606*^9, 3.777989830487995*^9}, 
   3.7779898938984222`*^9, {3.777998628383319*^9, 3.7779987650822067`*^9}, {
   3.7783747115873933`*^9, 3.7783747123371944`*^9}, {3.778420910066042*^9, 
   3.7784209109875765`*^9}, {3.780516710950988*^9, 3.7805167150125666`*^9}, {
   3.780516779310686*^9, 3.780516781841346*^9}, {3.785181334713604*^9, 
   3.7851813349858694`*^9}, {3.7930228575373435`*^9, 3.793022863182103*^9}, 
   3.7930241852424965`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"837d8969-4a8b-4321-a5c3-289b3db50d11"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create W Matrices", "Subsection",
 CellChangeTimes->{{3.7398161421530404`*^9, 3.7398161443136535`*^9}, {
  3.778000487845378*^9, 
  3.7780004887670465`*^9}},ExpressionUUID->"15e49cee-656b-4fbc-9867-\
6060a002ec1a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wavs", "=", 
   RowBox[{"caldata", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amp", "=", 
   RowBox[{"caldata", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psgMag", "=", 
   RowBox[{"caldata", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", "3"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psgOri", "=", 
   RowBox[{"caldata", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", "4"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psaMag", "=", 
   RowBox[{"caldata", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", "5"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psaOri", "=", 
   RowBox[{"caldata", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", "6"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psaLP", "=", 
   RowBox[{"caldata", "\[LeftDoubleBracket]", 
    RowBox[{";;", ",", "7"}], "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7805167868090315`*^9, 3.780516789948865*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"771cdb07-b24b-4bfc-a431-c436d4e93d60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"psg\[Theta]", " ", "=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "360", ",", 
        RowBox[{"(", 
         RowBox[{"360", "/", "64"}], ")"}]}], "]"}], "\[LeftDoubleBracket]", 
      RowBox[{";;", "64"}], "\[RightDoubleBracket]"}], "]"}], "\[Degree]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psa\[Theta]", " ", "=", " ", 
   RowBox[{"4.9", " ", "psg\[Theta]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"psgMM", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LR", "[", 
         RowBox[{
          RowBox[{
          "psgMag", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
           RowBox[{
           "psg\[Theta]", "\[LeftDoubleBracket]", "k", 
            "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "psgOri", "\[LeftDoubleBracket]", "#", 
            "\[RightDoubleBracket]"}]}]}], "]"}], ".", 
        RowBox[{"LP", "[", "0", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "64"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "amp", "]"}], "]"}]}]}], ";", 
  RowBox[{"psaMM", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"LP", "[", 
         RowBox[{
         "psaLP", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
         "]"}], ".", 
        RowBox[{"LR", "[", 
         RowBox[{
          RowBox[{
          "psaMag", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
           RowBox[{
           "psa\[Theta]", "\[LeftDoubleBracket]", "k", 
            "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "psaOri", "\[LeftDoubleBracket]", "#", 
            "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "64"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "amp", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.739816148687654*^9, 3.7398162150830083`*^9}, {
   3.7398185738053617`*^9, 3.7398185739233465`*^9}, {3.739820254493454*^9, 
   3.7398202684995546`*^9}, {3.739826378182118*^9, 3.739826380899212*^9}, {
   3.7398271046650596`*^9, 3.7398271092381754`*^9}, {3.777993247372743*^9, 
   3.7779932648221273`*^9}, {3.7779933382316065`*^9, 3.77799334591745*^9}, {
   3.777993825808216*^9, 3.7779938311661024`*^9}, {3.7779986115123634`*^9, 
   3.77799861219973*^9}, 3.7779993188961105`*^9, 3.7779994078276796`*^9, {
   3.7779995740724382`*^9, 3.7779996313330545`*^9}, {3.778003825405692*^9, 
   3.778003827452074*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"f53a88d0-8439-42eb-a2d3-b03b48a78b01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wMats", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"psaMM", "\[LeftDoubleBracket]", 
              RowBox[{"#", ",", "num", ",", "1", ",", "j"}], 
              "\[RightDoubleBracket]"}], " ", 
             RowBox[{"psgMM", "\[LeftDoubleBracket]", 
              RowBox[{"#", ",", "num", ",", "k", ",", "1"}], 
              "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"num", ",", "1", ",", "64"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "amp", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"wInvs", " ", "=", 
   RowBox[{"PseudoInverse", "/@", "wMats"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7398161786635075`*^9, 3.7398162190409136`*^9}, {
   3.7398167788935666`*^9, 3.7398168482289424`*^9}, {3.739817066842845*^9, 
   3.7398171043994365`*^9}, {3.7398171373481445`*^9, 3.7398173780992403`*^9}, 
   3.7398185306613083`*^9, {3.739818603851123*^9, 3.7398186075875254`*^9}, {
   3.7398186709571095`*^9, 3.7398186777226963`*^9}, {3.7398203805479174`*^9, 
   3.7398203843311434`*^9}, {3.739823384277274*^9, 3.7398233859242196`*^9}, {
   3.7398263526271057`*^9, 3.739826361668949*^9}, {3.7398264203804855`*^9, 
   3.7398264209734745`*^9}, 3.7398268923157263`*^9, {3.7398832077083344`*^9, 
   3.739883208006335*^9}, 3.739884714181278*^9, {3.7398854200501766`*^9, 
   3.73988542167195*^9}, {3.7398881267363324`*^9, 3.739888126878334*^9}, {
   3.777993389454435*^9, 3.777993389720004*^9}, {3.777999524646023*^9, 
   3.777999526895588*^9}, {3.7779996512847795`*^9, 3.7779996984772325`*^9}, {
   3.7779997838716307`*^9, 3.777999862992242*^9}, {3.7780002809769917`*^9, 
   3.778000327619773*^9}, {3.7780003722221365`*^9, 3.778000379841502*^9}, {
   3.7780004384191074`*^9, 3.7780004779726915`*^9}, 3.778003830732382*^9, 
   3.778003880586145*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"184802d2-47a7-4757-8359-b184e22aa7b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import Raw Images", "Subsection",
 CellChangeTimes->{{3.7779898838225937`*^9, 
  3.7779899128006115`*^9}},ExpressionUUID->"a487e5fa-d70f-4aef-8f9f-\
a911395a66a4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rawinfo", " ", "=", " ", 
  RowBox[{"Import", "[", 
   RowBox[{"rawfolder", "<>", "\"\<\\\\info.txt\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"refdet", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"rawfolder", "<>", "\"\<\\\\ref_readings.dat\>\""}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.777989971227445*^9, 3.777990028968774*^9}, {
   3.7779900748020477`*^9, 3.7779901536129384`*^9}, {3.777990184965162*^9, 
   3.7779901914011936`*^9}, {3.7779902750346565`*^9, 
   3.7779902783334093`*^9}, {3.7779912187831182`*^9, 
   3.7779912200171957`*^9}, {3.7779912697896414`*^9, 3.7779912701333017`*^9}, 
   3.778249283218996*^9, {3.785267966785116*^9, 3.785267986423175*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"8ad48ae6-ec68-4bcf-8118-fcefa2cd8059"],

Cell[BoxData["\<\"Air Calibration Measurement\\nJeremy Parkinson\\nROI: \
[800,800,256,256]\\nND = 1.0\\n3/11/2020 2:08:18 PM\\nspectral scan:450nm \
--750nm\\nspectral step size100nm\\nCamera Binning: 1.000000Exposure Time \
(s):0.080001Sensor Mode: 1.000000\\n\\nImage averaging: 1\\nCal file: \
C:\\\\Stepper \
Polarimeter\\\\Stepper_Testing\\\\air_20200310_400-800nm-05nm_test\\\\\
20200311 cal WLs 450-750nm-100\"\>"], "Output",
 CellChangeTimes->{
  3.785261047123476*^9, 3.785261116720538*^9, 3.7852612093772964`*^9, 
   3.7852612632697926`*^9, {3.785261878831443*^9, 3.785261907099059*^9}, {
   3.785267981155921*^9, 3.785267986697667*^9}, 3.79302221596168*^9, 
   3.793022249086068*^9, 3.7930228930507126`*^9, 3.7930229787635574`*^9, 
   3.793023918707735*^9, 3.7930241111850033`*^9, 3.7930251326985703`*^9, 
   3.793025204366517*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"e9a3c7df-5429-4761-892f-fddc62c554b2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"imSz", "=", 
   RowBox[{"{", 
    RowBox[{"256", ",", "256"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7782495042311754`*^9, 3.7782495160148554`*^9}, {
  3.785181606117128*^9, 3.7851816362069883`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"ddf4b6ff-3153-4c16-80aa-7b63cad22cf2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pos", "=", 
   RowBox[{"StringPosition", "[", 
    RowBox[{"rawinfo", ",", "\"\<spectral scan:\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"min\[Lambda]", "=", 
   RowBox[{
    RowBox[{"ToExpression", "[", 
     RowBox[{"StringTake", "[", 
      RowBox[{"rawinfo", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", "1"}], 
          ",", 
          RowBox[{
           RowBox[{"pos", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", "3"}]}], 
         "}"}], "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"max\[Lambda]", "=", 
   RowBox[{
    RowBox[{"ToExpression", "[", 
     RowBox[{"StringTake", "[", 
      RowBox[{"rawinfo", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"pos", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", "9"}], 
          ",", 
          RowBox[{
           RowBox[{"pos", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", "11"}]}],
          "}"}], "}"}]}], "]"}], "]"}], "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pos", "=", 
   RowBox[{"StringPosition", "[", 
    RowBox[{"rawinfo", ",", "\"\<spectral step size\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]\[Lambda]", " ", "=", " ", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"StringTake", "[", 
     RowBox[{"rawinfo", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"pos", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", "1"}], 
         ",", 
         RowBox[{
          RowBox[{"pos", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", "3"}]}], 
        "}"}], "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]List", " ", "=", " ", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{
     "min\[Lambda]", ",", "max\[Lambda]", ",", "\[CapitalDelta]\[Lambda]"}], 
     "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawnames", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<\\\\imageData\\\\images*.bin\>\"", ",", "rawfolder"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nwavs", "=", 
   RowBox[{"Length", "[", "\[Lambda]List", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nimgs", "=", "64"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inps", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"BinaryReadList", "[", 
      RowBox[{
       RowBox[{"rawfolder", "<>", "\"\<\\\\imageData\\\\images\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"#", "-", "1"}], "]"}], "<>", "\"\<.bin\>\""}], ",", 
       "\"\<Real32\>\"", ",", 
       RowBox[{"ByteOrdering", "\[Rule]", "1"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "nwavs", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"imgs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"inps", "\[LeftDoubleBracket]", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "k"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "imSz", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "*", 
                 RowBox[{
                 "imSz", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}], ";;", 
             RowBox[{
              RowBox[{"2", "k"}], "+", 
              RowBox[{"k", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "imSz", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "*", 
                 RowBox[{
                 "imSz", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}]}]}]}]}], 
           "\[RightDoubleBracket]"}], "/", 
          RowBox[{"refdet", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "#"}], "\[RightDoubleBracket]"}]}], ",", 
         "imSz"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "nimgs"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "nwavs", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "inps", "]"}], ";"}], "\n", 
 RowBox[{"winvindex", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"wavs", ",", "#"}], "]"}], "&"}], "/@", "\[Lambda]List"}], "//",
    "Flatten"}]}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Wavelength\>\"", ",", "\"\<Amplitude\>\"", ",", " ", 
        "\"\<PSG Mag\>\"", ",", " ", "\"\<PSG Ori\>\"", ",", 
        "\"\<PSA Ret Mag\>\"", ",", "\"\<PSA Ret Ori\>\"", ",", 
        "\"\<PSA LP Ori\>\"", ",", "\"\<RMSE\>\""}], "}"}], "}"}], ",", 
     RowBox[{"caldata", "\[LeftDoubleBracket]", 
      RowBox[{"winvindex", ",", 
       RowBox[{"1", ";;", "8"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7779914001537113`*^9, 3.777991401669241*^9}, {
   3.7779914409411726`*^9, 3.7779914492361555`*^9}, {3.7779921092534695`*^9, 
   3.777992190463334*^9}, {3.7779922304903355`*^9, 3.7779922904122133`*^9}, {
   3.7779926456921015`*^9, 3.777992646803735*^9}, 3.7780007918685665`*^9, {
   3.7780039257223034`*^9, 3.778003935891863*^9}, {3.7780039713368664`*^9, 
   3.778003971457429*^9}, {3.7780055610575495`*^9, 3.7780055781755085`*^9}, 
   3.7780101653639135`*^9, {3.778010227769888*^9, 3.778010230737921*^9}, {
   3.778010268109287*^9, 3.7780102686870413`*^9}, {3.7780132979546432`*^9, 
   3.778013298344974*^9}, {3.778013541125969*^9, 3.778013547024874*^9}, {
   3.7780138490313272`*^9, 3.778013868480067*^9}, {3.778249520484153*^9, 
   3.7782495555233936`*^9}, {3.785181452909679*^9, 3.785181506629774*^9}, {
   3.78526799572436*^9, 3.785268003608588*^9}, {3.7930251150579877`*^9, 
   3.7930251548829517`*^9}, 
   3.793025232844363*^9},ExpressionUUID->"0f7ed949-d54c-409a-ac97-\
0b4becebeab9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11", ",", "31", ",", "51", ",", "71"}], "}"}]], "Output",
 CellChangeTimes->{{3.793023952408963*^9, 3.7930239681882706`*^9}, 
   3.7930240479365716`*^9, 3.7930241173363914`*^9, 3.7930242095743227`*^9, 
   3.7930251707313504`*^9, 3.7930252049440117`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"ac798c17-4c78-4632-8899-4c4ec827e35a"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"Wavelength\"\>", "\<\"Amplitude\"\>", "\<\"PSG Mag\"\>", "\<\"PSG \
Ori\"\>", "\<\"PSA Ret Mag\"\>", "\<\"PSA Ret Ori\"\>", "\<\"PSA LP Ori\"\>", \
"\<\"RMSE\"\>"},
    {"450", "34707.59439629239`", "2.3457842858001046`", 
     RowBox[{"-", "0.028553683125861207`"}], "2.212435965097627`", 
     "0.08041605493966057`", "0.017989016043684032`", "0.10320194762863483`"},
    {"550", "95015.89003510946`", "1.8614823286574373`", 
     RowBox[{"-", "0.024554508241248774`"}], "1.8127226427584398`", 
     "0.09258196605765959`", "0.03476857045428471`", "0.07924069368691986`"},
    {"650", "80077.80685664386`", "1.540438436047721`", 
     RowBox[{"-", "0.023237791654521167`"}], "1.5116136442090335`", 
     "0.09670244464155993`", "0.040345940968415026`", "0.004818532588398471`"},
    {"750", "57041.93600822299`", "1.3240867882137723`", 
     RowBox[{"-", "0.022424419015395408`"}], "1.2967401463614598`", 
     "0.09868788801760214`", "0.04271955687117191`", "0.01215768184261683`"}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.793023952408963*^9, 3.7930239681882706`*^9}, 
   3.7930240479365716`*^9, 3.7930241173363914`*^9, 3.7930242095743227`*^9, 
   3.7930251707313504`*^9, 3.7930252049509945`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"b29dd95b-1286-4f46-8f8d-9f6df1417fe9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mmVecs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"wInvs", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{
          "winvindex", "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}],
           ",", ";;", ",", ";;"}], "\[RightDoubleBracket]"}], ".", 
        RowBox[{"imgs", "\[LeftDoubleBracket]", 
         RowBox[{"#", ",", ";;", ",", "k", ",", "l"}], 
         "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
         "imSz", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", 
         RowBox[{
         "imSz", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", "nwavs", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ListAnimate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Image", "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"mmVecs", "\[LeftDoubleBracket]", 
             RowBox[{"#", ",", ";;", ",", ";;", ",", ";;"}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", "nwavs", "]"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7779914001537113`*^9, 3.777991401669241*^9}, {
   3.7779914409411726`*^9, 3.7779914492361555`*^9}, {3.7779921092534695`*^9, 
   3.777992190463334*^9}, {3.7779922304903355`*^9, 3.7779922904122133`*^9}, {
   3.7779926456921015`*^9, 3.777992646803735*^9}, 3.7780007918685665`*^9, {
   3.7780039257223034`*^9, 3.778003935891863*^9}, {3.7780039713368664`*^9, 
   3.778003971457429*^9}, {3.7780055610575495`*^9, 3.7780055781755085`*^9}, {
   3.7780101653639135`*^9, 3.7780102591065793`*^9}, {3.7782496330661764`*^9, 
   3.778249649046596*^9}, {3.785181550216737*^9, 3.7851815529020348`*^9}, {
   3.7851816669643836`*^9, 3.7851816688902893`*^9}, {3.793024055653914*^9, 
   3.7930240577294054`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"0c83ad01-082f-4235-971d-d4399cb24121"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mm", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"mmVecs", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", ";;", ",", ";;", ",", ";;"}], 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mmavg", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"mm", "\[LeftDoubleBracket]", "n", "\[RightDoubleBracket]"}],
          "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "16"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"mmavg", "/", 
    RowBox[{"mmavg", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "//", 
   "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.7782504448898716`*^9, 3.7782504785695868`*^9}, 
   3.7782505521747513`*^9, {3.778252668732368*^9, 3.7782526712630134`*^9}, {
   3.778253169946538*^9, 3.778253170180832*^9}, {3.7782535879124217`*^9, 
   3.778253588006158*^9}, {3.778253906344292*^9, 3.778253906484662*^9}, {
   3.778254230196026*^9, 3.778254230586726*^9}, {3.7782545316800423`*^9, 
   3.778254532922961*^9}, {3.7782546563506594`*^9, 3.778254666101449*^9}, {
   3.778255003742021*^9, 3.778255004146307*^9}, 3.7851815595991697`*^9, {
   3.785268014384536*^9, 3.7852680148508463`*^9}, {3.7930241362181005`*^9, 
   3.7930241515301685`*^9}, 3.793024252016732*^9, 3.793024954900659*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"79c9f0cf-672f-4183-8bbd-e148517ac199"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", 
      RowBox[{"-", "0.016973019305763008`"}], 
      RowBox[{"-", "0.0010366393571720387`"}], "0.002522524998745651`"},
     {"0.008494072851670819`", "0.9391970655353751`", 
      RowBox[{"-", "0.25310917326321497`"}], 
      RowBox[{"-", "0.0013867786900973668`"}]},
     {
      RowBox[{"-", "0.10282051729792176`"}], "0.29088201713013523`", 
      "0.921939225618462`", 
      RowBox[{"-", "0.0018359248974094428`"}]},
     {"0.00029232853891505864`", 
      RowBox[{"-", "0.007581305753152867`"}], "0.0030622484886393335`", 
      "0.9444058558525943`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7930252089452724`*^9},
 CellLabel->
  "Out[45]//MatrixForm=",ExpressionUUID->"5beb8822-9166-491a-813b-\
7b48ae9cd929"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Grid", "[", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ListDensityPlot", "[", 
        RowBox[{
         RowBox[{"#", "/", 
          RowBox[{"mm", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", ";;", ",", ";;"}], "\[RightDoubleBracket]"}]}], 
         ",", 
         RowBox[{"ColorFunction", "\[Rule]", "divergingCF"}], ",", 
         RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
         RowBox[{"Frame", "\[Rule]", "False"}]}], "]"}], "&"}], "/@", "mm"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "//", 
  "Quiet"}]], "Input",
 CellChangeTimes->{{3.7782503320103583`*^9, 3.7782503712978525`*^9}, {
  3.778250401648365*^9, 3.778250434890339*^9}, {3.778250483822857*^9, 
  3.7782504909509916`*^9}, {3.7782505658781633`*^9, 3.778250582757167*^9}, {
  3.778250663285406*^9, 3.7782506750549517`*^9}, {3.778252660982283*^9, 
  3.7782526625756097`*^9}, {3.78526205281321*^9, 3.78526205551499*^9}, {
  3.793022945247469*^9, 3.79302294536316*^9}, {3.793024941241332*^9, 
  3.793024941388941*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"13d493e0-4e48-43c1-8954-01ddc46f3ce8"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7930252105309973`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"de46201b-d753-46e3-b247-0cd5ec058916"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", "/", 
            RowBox[{"mm", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", ";;", ",", ";;"}], "\[RightDoubleBracket]"}]}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", ".05"}], "}"}]}], "]"}], "&"}],
        "/@", "mm"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "//", "Quiet"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7782529292064114`*^9, 3.778252958397601*^9}, {
   3.7782529885175266`*^9, 3.778253036136944*^9}, {3.778253084268434*^9, 
   3.7782530946920414`*^9}, {3.778253955937193*^9, 3.778253962252658*^9}, 
   3.7782540802760572`*^9, {3.7930222725311403`*^9, 3.793022274349804*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"184bc04b-49ba-4a32-8a09-fc1da28e0ab0"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.3 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 257, 4, 69, "Subsection",ExpressionUUID->"93bba039-cb26-420b-9693-30ed7b778de6"],
Cell[840, 28, 4732, 130, 88, "Input",ExpressionUUID->"00d0b968-c44a-49c8-b9dc-19f48c4d41e1"],
Cell[CellGroupData[{
Cell[5597, 162, 465, 7, 58, "Subsubsection",ExpressionUUID->"c6b53c55-4dc4-4e1b-96c1-1c1b4ca35e95"],
Cell[6065, 171, 2850, 70, 413, "Input",ExpressionUUID->"2fc0ecbb-a6bc-4eac-a2c1-b201403c48e9"],
Cell[8918, 243, 4322, 96, 513, "Input",ExpressionUUID->"5e4045f6-4138-4d28-8b88-471587266ed3"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13289, 345, 261, 4, 84, "Section",ExpressionUUID->"77072588-5cee-4ef9-b0a4-0fcc2c01a233"],
Cell[CellGroupData[{
Cell[13575, 353, 215, 4, 69, "Subsection",ExpressionUUID->"21d5a76f-0bd4-468e-8757-5bb1bdd54c5a"],
Cell[13793, 359, 1694, 29, 88, "Input",ExpressionUUID->"15104482-c3a9-4d2e-ad53-d6f57ac562e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15524, 393, 160, 3, 69, "Subsection",ExpressionUUID->"91add12a-b1b3-4008-ac66-dda7510c8d9d"],
Cell[15687, 398, 687, 16, 88, "Input",ExpressionUUID->"5ead8e19-4fee-400a-8721-0d3e45255dae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16411, 419, 173, 3, 69, "Subsection",ExpressionUUID->"fcad4808-2bfe-4560-b096-d726a7756029"],
Cell[16587, 424, 1423, 29, 63, "Input",ExpressionUUID->"837d8969-4a8b-4321-a5c3-289b3db50d11"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18047, 458, 220, 4, 69, "Subsection",ExpressionUUID->"15e49cee-656b-4fbc-9867-6060a002ec1a"],
Cell[18270, 464, 1371, 36, 188, "Input",ExpressionUUID->"771cdb07-b24b-4bfc-a431-c436d4e93d60"],
Cell[19644, 502, 2872, 74, 113, "Input",ExpressionUUID->"f53a88d0-8439-42eb-a2d3-b03b48a78b01"],
Cell[22519, 578, 2347, 46, 63, "Input",ExpressionUUID->"184802d2-47a7-4757-8359-b184e22aa7b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24903, 629, 169, 3, 69, "Subsection",ExpressionUUID->"a487e5fa-d70f-4aef-8f9f-a911395a66a4"],
Cell[CellGroupData[{
Cell[25097, 636, 808, 16, 63, "Input",ExpressionUUID->"8ad48ae6-ec68-4bcf-8118-fcefa2cd8059"],
Cell[25908, 654, 922, 14, 294, "Output",ExpressionUUID->"e9a3c7df-5429-4761-892f-fddc62c554b2"]
}, Open  ]],
Cell[26845, 671, 323, 7, 37, "Input",ExpressionUUID->"ddf4b6ff-3153-4c16-80aa-7b63cad22cf2"],
Cell[CellGroupData[{
Cell[27193, 682, 6839, 175, 363, "Input",ExpressionUUID->"0f7ed949-d54c-409a-ac97-0b4becebeab9"],
Cell[34035, 859, 372, 6, 43, "Output",ExpressionUUID->"ac798c17-4c78-4632-8899-4c4ec827e35a"],
Cell[34410, 867, 1489, 25, 141, "Output",ExpressionUUID->"b29dd95b-1286-4f46-8f8d-9f6df1417fe9"]
}, Open  ]],
Cell[35914, 895, 2420, 56, 63, "Input",ExpressionUUID->"0c83ad01-082f-4235-971d-d4399cb24121"],
Cell[CellGroupData[{
Cell[38359, 955, 1695, 39, 63, "Input",ExpressionUUID->"79c9f0cf-672f-4183-8bbd-e148517ac199"],
Cell[40057, 996, 1265, 32, 124, "Output",ExpressionUUID->"5beb8822-9166-491a-813b-7b48ae9cd929"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41359, 1033, 1219, 27, 37, "Input",ExpressionUUID->"13d493e0-4e48-43c1-8954-01ddc46f3ce8"],
Cell[42581, 1062, 158, 2, 43, "Output",ExpressionUUID->"de46201b-d753-46e3-b247-0cd5ec058916"]
}, Open  ]],
Cell[42754, 1067, 1054, 26, 37, "Input",ExpressionUUID->"184bc04b-49ba-4a32-8a09-fc1da28e0ab0"]
}, Open  ]]
}, Open  ]]
}
]
*)

